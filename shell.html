<!DOCTYPE html>
<html>

<head>
    <title>My Template</title>
    <meta charset="UTF-8">
    <style>
        html {
            overflow: hidden;
        }
    </style>
</head>

<body>
    <canvas id="canvas"></canvas>

    <script src="$GODOT_URL"></script>
    <iframe
        src="https://player.twitch.tv/?channel=kuviboy&parent=html-classic.itch.zone&parent=badcop.itch.io&autoplay=true&muted=false"
        height="225" width="400" style="z-index:1000;position:absolute;top:0;left:0;border:0;background-color:red;">
    </iframe>
    <script>
        var engine = new Engine($GODOT_CONFIG);
        engine.startGame();
        let iframe = document.querySelector("iframe");
        function position_iframe(x, y) {
            iframe.style.left = `${x}px`;
            iframe.style.top = `${y}px`;
        }
        function resize_iframe(x, y, factor) {
            iframe.width = `${x * factor}px`;
            iframe.height = `${y * factor}px`;
        }
        function cc() {
            let w = window.innerWidth;
            let h = window.innerHeight;
            let factor = Math.max(1, Math.min(Math.floor(w / 400), Math.floor(h / 288)));
            resize_iframe(window.sx, window.sy, factor);
            let fw = window.sx * factor;
            let fh = window.sy * factor;
            let bx = (w - fw) / 2.0;
            let by = (h - fh) / 2.0;
            let zx = bx + window.x * factor;
            let zy = by + window.y * factor;
            position_iframe(zx, zy);
            if (zx + fw > 0 && zy + fh > 0 && zx < w && zy < h) {
                iframe.style.display = 'inline';
            } else {
                iframe.style.display = 'none';
            }
        }
        window.cc = cc;
    </script>

</body>

</html>